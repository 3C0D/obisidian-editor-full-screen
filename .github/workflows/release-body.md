previous version saved before total refactoring